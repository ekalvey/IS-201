<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ethan Alvey - Snake Game</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <style>
    html, body { height: 100%; margin: 0; font-family: 'Nunito', sans-serif; }
    body { display: flex; flex-direction: column; }
    main { flex: 1; display: flex; justify-content: center; align-items: center; background: #f5f5f5; height: calc(100vh - 70px); }
    #game-container { text-align: center; position: relative; background: #1a1a1a; padding: 30px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
    #score { font-size: 28px; margin-bottom: 20px; font-weight: bold; color: #f8f9fa; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
    canvas { background: #000; border-radius: 12px; border: 3px solid #333; display: block; margin: 0 auto; max-width: 100%; height: auto; }
    #popup { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; display: flex; justify-content: center; align-items: center; z-index: 10; pointer-events: none; }
    #popup-content { background: #fff; padding: 30px 50px; border-radius: 15px; text-align: center; font-size: 22px; pointer-events: all; box-shadow: 0 8px 20px rgba(0,0,0,0.4); }
    #popup-content button { margin-top: 20px; padding: 12px 25px; font-size: 18px; border: none; border-radius: 8px; cursor: pointer; background-color: #007bff; color: white; transition: background 0.3s; }
    #popup-content button:hover { background-color: #0056b3; }
    @media (max-width: 500px) {
      #popup-content { padding: 20px 30px; font-size: 18px; }
      #popup-content button { padding: 10px 20px; font-size: 16px; }
      #score { font-size: 22px; }
      canvas { width: 300px; height: 300px; }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-light" id="mainNav">
    <div class="container px-4 px-lg-5">
      <a class="navbar-brand" href="index.html">Ethan Alvey</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive">
        Menu <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html#about">About</a></li>
          <li class="nav-item"><a class="nav-link" href="snake.html">Snake Game</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#signup">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main content -->
  <main>
    <div id="game-container">
      <div id="score">Score: 0 | High Score: 0</div>
      <canvas id="game" width="400" height="400"></canvas>
    </div>
    <div id="popup">
      <div id="popup-content">
        <div id="popup-message">Start Game</div>
        <button id="popup-btn">Start</button>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("score");
    const popup = document.getElementById("popup");
    const popupMessage = document.getElementById("popup-message");
    const popupBtn = document.getElementById("popup-btn");

    const box = 20;
    let score = 0;
    let snake = [{ x: 10 * box, y: 10 * box }];
    let food = { x: Math.floor(Math.random() * 20) * box, y: Math.floor(Math.random() * 20) * box };
    let direction = "RIGHT";
    let gameLoop = null;

    // Load high score from localStorage
    let highScore = localStorage.getItem("snakeHighScore") || 0;

    function updateScore() {
      scoreDisplay.textContent = `Score: ${score} | High Score: ${highScore}`;
    }

    document.addEventListener("keydown", changeDirection);

    function changeDirection(e) {
      if (e.key === "ArrowUp" && direction !== "DOWN") direction = "UP";
      else if (e.key === "ArrowDown" && direction !== "UP") direction = "DOWN";
      else if (e.key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
      else if (e.key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
    }

    function draw() {
      ctx.fillStyle = "#000";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "red";
      ctx.fillRect(food.x, food.y, box, box);

      ctx.fillStyle = "lime";
      snake.forEach(seg => ctx.fillRect(seg.x, seg.y, box, box));

      let head = { ...snake[0] };
      if (direction === "UP") head.y -= box;
      if (direction === "DOWN") head.y += box;
      if (direction === "LEFT") head.x -= box;
      if (direction === "RIGHT") head.x += box;

      if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height || snake.some(seg => seg.x === head.x && seg.y === head.y)) {
        clearInterval(gameLoop);
        gameLoop = null;
        // Update high score if needed
        if(score > highScore) {
          highScore = score;
          localStorage.setItem("snakeHighScore", highScore);
        }
        updateScore();
        showPopup("Game Over! Final Score: " + score, "Restart");
        return;
      }

      if (head.x === food.x && head.y === food.y) {
        score++;
        if(score > highScore) highScore = score;
        updateScore();
        food = { x: Math.floor(Math.random() * 20) * box, y: Math.floor(Math.random() * 20) * box };
      } else {
        snake.pop();
      }

      snake.unshift(head);
    }

    function startGame() {
      if (!gameLoop) gameLoop = setInterval(draw, 120);
    }

    function restartGame() {
      score = 0;
      snake = [{ x: 10 * box, y: 10 * box }];
      food = { x: Math.floor(Math.random() * 20) * box, y: Math.floor(Math.random() * 20) * box };
      direction = "RIGHT";
      updateScore();
      draw();
      startGame();
    }

    function showPopup(message, btnText) {
      popupMessage.textContent = message;
      popupBtn.textContent = btnText;
      popup.style.display = "flex";
    }

    popupBtn.addEventListener("click", () => {
      popup.style.display = "none";
      restartGame();
    });

    updateScore();
    showPopup("Start Game", "Start");
  </script>
</body>
</html>